<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask API Test Page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        function getDevices() {
            $.get("/api/getDevices", function(data) {
                $('#devicesResult').text(JSON.stringify(data, null, 2));
            }).fail(function(error) {
                $('#devicesResult').text('Error: ' + error.responseText);
            });
        }

        function getImageDirectories() {
            var deviceId = $('#deviceIdForDirectories').val();
            $.get("/api/getImageDirectories", { deviceId: deviceId }, function(data) {
                $('#directoriesResult').text(JSON.stringify(data, null, 2));
            }).fail(function(error) {
                $('#directoriesResult').text('Error: ' + error.responseText);
            });
        }

        function getImagesAndInferences() {
            var deviceId = $('#deviceIdForImages').val();
            var imagePath = $('#imagePath').val();
            var numberOfImages = $('#numberOfImages').val();
            $.get("/api/getImagesAndInferences", { 
                deviceId: deviceId, 
                imagePath: imagePath,
                numberOfImages: numberOfImages 
            }, function(data) {
                displayImages(data);
            }).fail(function(error) {
                $('#imagesResult').text('Error: ' + error.responseText);
            });
        }

        function displayImages(data) {
            $('#imagesResult').empty(); // Clear previous results
            data.forEach(item => {
                const imageElement = $('<img>', { src: item.image, alt: 'Loaded Image' });
                $('#imagesResult').append(imageElement);
    
                // Optionally display additional data, such as inference data and timestamp
                if (item.timestamp) {
                    const timestamp = $('<p>').text(`Timestamp: ${item.timestamp}`);
                    $('#imagesResult').append(timestamp);
                }
    
                // If there's inference data, display it
                if (item.inferenceData) {
                    const inferenceData = JSON.parse(item.inferenceData);
                    // Display or process the inference data as needed
                }
            });
        }
    </script>
</head>
<body>
    <h1>Flask API Test Page</h1>

    <button onclick="getDevices()">Get Devices</button>
    <pre id="devicesResult"></pre>

    <input type="text" id="deviceIdForDirectories" placeholder="Enter Device ID">
    <button onclick="getImageDirectories()">Get Image Directories</button>
    <pre id="directoriesResult"></pre>

    <input type="text" id="deviceIdForImages" placeholder="Enter Device ID">
    <input type="text" id="imagePath" placeholder="Enter Image Path">
    <input type="number" id="numberOfImages" placeholder="Number of Images">
    <button onclick="getImagesAndInferences()">Get Images and Inferences</button>
    <pre id="imagesResult"></pre>
</body>
</html>
